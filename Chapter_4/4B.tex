\section{模型参考自适应控制：标量系统的设计}\label{4Bref}

\subsection{引入}

\subsection{标量系统的直接型MRAC设计}
考虑如下一阶系统
\begin{equation}
  \dot{x} = a  x + b  u \label{Sys:MRAC:scalar}
\end{equation}
其中 $a, b$为{\bf 未知}参数，但$b$的符号$\sgn(b)$已知。

我们的控制目标是，设计$u$，使得闭环系统的所有信号都有界，且$x$能够跟踪下述参考模型的参考状态 $x_{\ensuremath{\operatorname{ref}}}$：
\begin{equation}
  \dot{x}_{\ensuremath{\operatorname{ref}}} = -
  a_{\ensuremath{\operatorname{ref}}} x_{\ensuremath{\operatorname{ref}}} +
  b_{\ensuremath{\operatorname{ref}}} u_c \label{Sys:MRAC:scalar:ref}
\end{equation}
其中 $a_{\ensuremath{\operatorname{ref}}} > 0$和
$b_{\ensuremath{\operatorname{ref}}}$为已知常数（是我们所期望的值），$u_c
(t)$是（虚拟的）输入指令，其有界且分段连续。

在不考虑模型参数未知的情况下，我们先采用以下控制律
\begin{equation}
  u = k^{\ast}_1 x + k^{\ast}_2 u_c \label{u*:k1*xk2*uc}
\end{equation}
其中 $k^{\ast}_1, k^{\ast}_2$ 是（我们所期望的）已知常数。这样，闭环系统 \eqref{Sys:MRAC:scalar} 就成为
\begin{align*}
  \dot{x} & = a  x + b  (k^{\ast}_1 x + k^{\ast}_2 u_c)\\
  & = (a + b  k^{\ast}_1)  x + b  k^{\ast}_2 u_c
\end{align*}
这样，对比 \eqref{Sys:MRAC:scalar:ref} 和上式就可得出，理想情况下跟踪参考模型时，参数
$k^{\ast}_1, k^{\ast}_2$应满足
\begin{equation}
  k^{\ast}_1 = \frac{-a - a_{\ensuremath{\operatorname{ref}}}}{b}, k^{\ast}_2 =
  \frac{b_{\ensuremath{\operatorname{ref}}}}{b} \label{k1*k2*}
\end{equation}

然而，当 $a, b$ 未知时，理想的 \eqref{k1*k2*} 无法实际应用。因此，将 \eqref{u*:k1*xk2*uc} 改造
为下述具有可调参数的控制律
\begin{equation}
  u = \hat{k}_1 (t) x + \hat{k}_2 (t) u_c \label{u:k1xk2uc}
\end{equation}
其中 $\hat{k}_1 (t), \hat{k}_2 (t)$ 分别是 $k^{\ast}_1,k^{\ast}_2$的估计。

将 \eqref{u:k1xk2uc} 代入 \eqref{Sys:MRAC:scalar} 有
\begin{equation}
  \dot{x} = (a + b \hat{k}_1 (t)) x + b \hat{k}_2 (t) u_c \label{Sys:MRAC:scalar:hat}
\end{equation}
定义{\bf 跟踪误差}
\begin{equation*}
  e \triangleq x - x_{\ensuremath{\operatorname{ref}}}
\end{equation*}
根据 \eqref{Sys:MRAC:scalar:ref} 和 \eqref{Sys:MRAC:scalar:hat}，可推导出误差动力学是
\begin{align}
  \dot{e} & = \dot{x} - \dot{x}_{\ensuremath{\operatorname{ref}}}
  \nonumber\\
  & = (a + b \hat{k}_1 (t)) x + b \hat{k}_2 (t) u_c +
  a_{\ensuremath{\operatorname{ref}}} x_{\ensuremath{\operatorname{ref}}} -
  b_{\ensuremath{\operatorname{ref}}} u_c \nonumber\\
  & = (a + a_{\ensuremath{\operatorname{ref}}} + b \hat{k}_1 (t)) x + (b
  \hat{k}_2 (t) - b_{\ensuremath{\operatorname{ref}}}) u_c -
  a_{\ensuremath{\operatorname{ref}}} (x - x_{\ensuremath{\operatorname{ref}}}) \nonumber
\end{align}
结合 \eqref{k1*k2*}，发现上式可写为
\[\dot{e} = - a_{\ensuremath{\operatorname{ref}}} e + b (\hat{k}_1(t)-k^{\ast}_1) x + b (\hat{k}_2 (t) - k^{\ast}_2) u_c\]
第二项和第三项中的括号可理解为对$k^{\ast}_1,k^{\ast}_2$的参数估计误差，于是定义
\[\tilde{k}_1 = \hat{k}_1 (t) - k^{\ast}_1,\tilde{k}_2 = \hat{k}_2
(t) - k^{\ast}_2\]则有
\begin{equation}
  \dot{e} = - a_{\ensuremath{\operatorname{ref}}} e + b \tilde{k}_1 x + b 
  \tilde{k}_2 u_c  \label{err:MRAC:scalar}
\end{equation}

下面的目标是让各误差$e,\tilde{k}_1,\tilde{k}_2$收敛至$0$，进而使$x$跟踪$x_\mathrm{ref}$。
考虑候选Lyapunov函数
\begin{equation}
  V = \frac{1}{2} e^2 + \frac{1}{2} \tilde{k}^2_1 + \frac{1}{2} \tilde{k}^2_2\label{not_implement_candidate}
\end{equation}
沿 \eqref{err:MRAC:scalar} 的状态轨线，求其对时间的导数得（注意$\dot{\tilde{k}}_1=\dot{\hat{k}}_1$，$\dot{\tilde{k}}_2=\dot{\hat{k}}_2$）
\begin{align}
  \dot{V} & = e  \dot{e} + \tilde{k} _1 \dot{\hat{k}}_1 + \tilde{k} _2
  \dot{\hat{k}}_2 \nonumber\\
  & = - a_{\ensuremath{\operatorname{ref}}} e^2 + b \tilde{k} _1 x  e + b
  \tilde{k} _2 u_c e + \tilde{k} _1 \dot{\hat{k}}_1 + \tilde{k} _2
  \dot{\hat{k}}_2 \nonumber\\
  & = - a_{\ensuremath{\operatorname{ref}}} e^2 + \tilde{k} _1
  (\dot{\hat{k}}_1 + b  x  e) + \tilde{k} _2 (\dot{\hat{k}}_2 + b  u_c e) \label{not_implement_vdot}
\end{align}
如果我们将第二项与第三项消去，即选取
\begin{equation}
  \dot{\hat{k}}_1 = - b  x  e, \dot{\hat{k}}_2 = - b  u_c e
  \label{k1k2:not:implemented}
\end{equation}
则可得 $\dot{V} \leq 0$。然而，由于 $b$ 未知，不能直接应用 \eqref{k1k2:not:implemented}。

我们发现，如果在 \eqref{not_implement_candidate} 的第二、三项中乘上$b$，那么 \eqref{not_implement_vdot} 的后两项中
$b$就可提出，进而设计$\dot{\hat{k}}_1,\dot{\hat{k}}_2$消去的项就不含有$b$。然而，由于$b$可能为负，所以可能使$V$不再正定。
于是，考虑加入$|b|$，这样会产生$\sgn(b)$，但其已知。进而，考虑下述候选Lyapunov函数：
\begin{equation}
  V = \frac{1}{2} e^2 + \frac{| b |}{2 \gamma_1} \tilde{k}^2_1 + \frac{| b
  |}{2 \gamma_2} \tilde{k}^2_2 \label{Lyafun:ek1k2}
\end{equation}
其中 $\gamma_1, \gamma_2 > 0$。

沿 \eqref{err:MRAC:scalar} 的状态轨线，求其对时间的导数得
\[ \dot{V} = - a_{\ensuremath{\operatorname{ref}}} e^2 + \frac{| b
   |}{\gamma_1} \widetilde{ k} _1 (\dot{\hat{k}}_1 + \gamma_1
   \ensuremath{\operatorname{sgn}} (b) x  e) + \frac{| b |}{\gamma_2}
   \tilde{k} _2 (\dot{\hat{k}}_2 + \gamma_2 \ensuremath{\operatorname{sgn}}
   (b)  u_c e) \]
此时，如果我们选取
\begin{equation}
  \dot{\hat{k}}_1 = -  \gamma_1 \ensuremath{\operatorname{sgn}} (b) x  e,
  \dot{\hat{k}}_2 = -  \gamma_2 \ensuremath{\operatorname{sgn}} (b)  u_c e
\end{equation}
则
\begin{equation*}
  \dot{V} = - a_{\ensuremath{\operatorname{ref}}} e^2 \leq 0
\end{equation*}
从而$V (t) \leq V (0)$。由 \eqref{Lyafun:ek1k2}，$e, \tilde{k} _1,
\tilde{k} _2$ 都有界；又由于$x_\mathrm{ref}$和$u_c$有界，因此 $x$有界。

根据误差动力学 \eqref{err:MRAC:scalar}，$\ddot{V} = - 2a_{\ensuremath{\operatorname{ref}}} e  \dot{e}$ 也有界。

因此根据 Barbalat引理（\ref{barbalat}），$\lim\limits_{t \rightarrow \infty}
\dot{V} (t) = 0$，也即 $\lim\limits_{t \rightarrow \infty} e (t) = 0$。

\begin{table}[h]
  \centering
  \setcellgapes{4pt}
  \makegapedcells
  \caption{标量系统的直接型MRAC设计步骤}
  \begin{tabular}{p{4.0cm}p{10.0cm}}
    \hline
    开环被控对象 & $\dot{x} = - a  x + b  u$; $\{ a, b \}$ 未知，但
    $\ensuremath{\operatorname{sgn}} (b)$ 已知\\
    参考模型 & $\dot{x}_{\ensuremath{\operatorname{ref}}} = -
    a_{\ensuremath{\operatorname{ref}}} x_{\ensuremath{\operatorname{ref}}} +
    b_{\ensuremath{\operatorname{ref}}} u_c$\\
    跟踪误差 & $e \triangleq x - x_{\ensuremath{\operatorname{ref}}}$\\
    控制输入 & $u = \hat{k}_1 (t) x + \hat{k}_2 (t) u_c$\\
    直接型MRAC控制律& $\dot{\hat{k}}_1 = -  \gamma_1
    \ensuremath{\operatorname{sgn}} (b) x  e, \dot{\hat{k}}_1 = -  \gamma_2
    \ensuremath{\operatorname{sgn}} (b)  u_c e ; \gamma_1, \gamma_2 > 0$\\
    \hline
  \end{tabular}
\end{table}

设计步骤：
\begin{enumerate}
  \item 根据已知参数，寻求一种控制器结构
  
  \item 导出误差动力学
  
  \item 找出 Lyapunov函数
  
  \item 设计参数更新规则，使得 $\dot{V} \leq 0$
\end{enumerate}

\subsection{标量系统的非直接型模型参考自适应控制}

\[\dot{x}=ax+bu\]

\[\dot{x}_{ref}=-a_{ref}x_{ref}+b_{ref}u_c,a_ref>0\]

\[\dot{\hat{b}}(t)=\begin{cases}
  \gamma_2ue&\text{若}\ |\hat{b}|>b_{\min}\\
  &\text{或}\ |\hat{b}|=b_{\min}\ \text{且}\ ue\sgn(b)\ge 0\\
  0&\text{其他}
\end{cases}\]
