\section{模型参考自适应控制：标量系统的设计}\label{4Bref}

\subsection{引入}

\subsection{标量系统的直接型模型参考自适应控制}
Consider the following first-order system
\begin{equation}
  \dot{x} = - a  x + b  u \label{Sys:MRAC:scalar}
\end{equation}
where $a, b$ are unknown parameters but the sign of $b$ is known.

Control objective: design $u$ such that all signals in the closed-loop system
are bounded, and $x$ tracks the state $x_{\ensuremath{\operatorname{ref}}}$ of
the following reference model
\begin{equation}
  \dot{x}_{\ensuremath{\operatorname{ref}}} = -
  a_{\ensuremath{\operatorname{ref}}} x_{\ensuremath{\operatorname{ref}}} +
  b_{\ensuremath{\operatorname{ref}}} u_c \label{Sys:MRAC:scalar:ref}
\end{equation}
where $a_{\ensuremath{\operatorname{ref}}} > 0$ and
$b_{\ensuremath{\operatorname{ref}}}$ are the desired known constants, $u_c
(t)$ is the input command which is bounded and piecewise continuous.

We propose the control law
\begin{equation}
  u = k^{\ast}_1 x + k^{\ast}_2 u_c \label{u*:k1*xk2*uc}
\end{equation}
where $k^{\ast}_1, k^{\ast}_2$ are the desired known constants. The
closed-loop system of \eqref{Sys:MRAC:scalar} and \eqref{u*:k1*xk2*uc} is
\begin{eqnarray*}
  \dot{x} & = & - a  x + b  (k^{\ast}_1 x + k^{\ast}_2 u_c)\\
  & = & - (a - b  k^{\ast}_1)  x + b  k^{\ast}_2 u_c
\end{eqnarray*}
Then the perfect model condition is
\begin{equation}
  k^{\ast}_1 = \frac{a - a_{\ensuremath{\operatorname{ref}}}}{b}, k^{\ast}_2 =
  \frac{b_{\ensuremath{\operatorname{ref}}}}{b} \label{k1*k2*}
\end{equation}
When $a, b$ are unknown, \eqref{k1*k2*} cannot be implemented. Therefore,
instead of \eqref{u*:k1*xk2*uc}, we propose the following control law with
adjustable parameters.
\begin{equation}
  u = \hat{k}_1 (t) x + \hat{k}_2 (t) u_c \label{u:k1xk2uc}
\end{equation}
where $\hat{k}_1 (t), \hat{k}_2 (t)$ are the estimates of $k^{\ast}_1,
k^{\ast}_2$, respectively.

We substitute \eqref{u:k1xk2uc} into \eqref{Sys:MRAC:scalar}
\begin{equation}
  \dot{x} = - (a - b \hat{k}_1 (t)) x + b \hat{k}_2 (t) u_c
\end{equation}
Define the tracking error
\begin{equation}
  e \triangleq x - x_{\ensuremath{\operatorname{ref}}}
\end{equation}
We can get from \eqref{k1*k2*} that
\begin{eqnarray}
  \dot{e} & = & \dot{x} - \dot{x}_{\ensuremath{\operatorname{ref}}}
  \nonumber\\
  & = & - (a - b \hat{k}_1 (t)) x + b \hat{k}_2 (t) u_c +
  a_{\ensuremath{\operatorname{ref}}} x_{\ensuremath{\operatorname{ref}}} -
  b_{\ensuremath{\operatorname{ref}}} u_c \nonumber\\
  & = & - (a - a_{\ensuremath{\operatorname{ref}}} - b \hat{k}_1 (t)) x + (b
  \hat{k}_2 (t) - b_{\ensuremath{\operatorname{ref}}}) u_c -
  a_{\ensuremath{\operatorname{ref}}} e \nonumber\\
  & = & - a_{\ensuremath{\operatorname{ref}}} e - b (k^{\ast}_1 - \hat{k}_1
  (t)) x + b (\hat{k}_2 (t) - k^{\ast}_2) u_c \nonumber\\
  & = & - a_{\ensuremath{\operatorname{ref}}} e + b \tilde{k}_1 x + b 
  \tilde{k}_2 u_c  \label{err:MRAC:scalar}
\end{eqnarray}
where $\tilde{k}_1 = \hat{k}_1 (t) - k^{\ast}_1$ and $\tilde{k}_2 = \hat{k}_2
(t) - k^{\ast}_2$.

Consider a Lyapunov function candidate
\begin{equation}
  V = \frac{1}{2} e^2 + \frac{1}{2} \tilde{k}^2_1 + \frac{1}{2} \tilde{k}^2_2
\end{equation}
Taking the time derivative of $V$, along the trajectories of
\eqref{err:MRAC:scalar}, gives
\begin{eqnarray}
  \dot{V} & = & e  \dot{e} + \tilde{k} _1 \dot{\hat{k}}_1 + \tilde{k} _2
  \dot{\hat{k}}_2 \nonumber\\
  & = & - a_{\ensuremath{\operatorname{ref}}} e^2 + b \tilde{k} _1 x  e + b
  \tilde{k} _2 u_c e + \tilde{k} _1 \dot{\hat{k}}_1 + \tilde{k} _2
  \dot{\hat{k}}_2 \nonumber\\
  & = & - a_{\ensuremath{\operatorname{ref}}} e^2 + \tilde{k} _1
  (\dot{\hat{k}}_1 + b  x  e) + \tilde{k} _2 (\dot{\hat{k}}_2 + b  u_c e) 
\end{eqnarray}
If we choose
\begin{equation}
  \dot{\hat{k}}_1 = - b  x  e, \dot{\hat{k}}_1 = - b  u_c e
  \label{k1k2:not:implemented}
\end{equation}
We can get that $\dot{V} \leq 0$. However, \eqref{k1k2:not:implemented} cannot
be implemented since $b$ is unknown.

We consider the following Lyapunov function candidate
\begin{equation}
  V = \frac{1}{2} e^2 + \frac{| b |}{2 \gamma_1} \tilde{k}^2_1 + \frac{| b
  |}{2 \gamma_2} \tilde{k}^2_2 \label{Lyafun:ek1k2}
\end{equation}
where $\gamma_1, \gamma_2 > 0$.

Taking the time derivative of $V$, along the trajectories of
\eqref{err:MRAC:scalar}, gives
\[ \dot{V} = - a_{\ensuremath{\operatorname{ref}}} e^2 + \frac{| b
   |}{\gamma_1} \widetilde{ k} _1 (\dot{\hat{k}}_1 + \gamma_1
   \ensuremath{\operatorname{sgn}} (b) x  e) + \frac{| b |}{\gamma_2}
   \tilde{k} _2 (\dot{\hat{k}}_2 + \gamma_2 \ensuremath{\operatorname{sgn}}
   (b)  u_c e) \]
If we choose
\begin{equation}
  \dot{\hat{k}}_1 = -  \gamma_1 \ensuremath{\operatorname{sgn}} (b) x  e,
  \dot{\hat{k}}_2 = -  \gamma_2 \ensuremath{\operatorname{sgn}} (b)  u_c e
\end{equation}
which leads to
\begin{equation}
  \dot{V} = - a_{\ensuremath{\operatorname{ref}}} e^2 \leq 0
\end{equation}
Thus, $V (t) \leq V (0)$. From \eqref{Lyafun:ek1k2}, $e, \tilde{k} _1,
\tilde{k} _2$ are bounded and $x$ is bounded.

From \eqref{err:MRAC:scalar}, $\ddot{V} = - 2
a_{\ensuremath{\operatorname{ref}}} e  \dot{e}$ is also bounded.

We can conclude from Barbalat's lemma that $\lim_{t \rightarrow \infty}
\dot{V} (t) = 0, i.e.$ $\lim_{t \rightarrow \infty} e (t) = 0.$

\begin{table}[h]
  \centering
  \caption{标量系统的直接型MRAC设计步骤}
  \begin{tabular}{p{4.0cm}p{10.0cm}}
    \hline
    开环被控对象 & $\dot{x} = - a  x + b  u$; $\{ a, b \}$ are unknown,
    $\ensuremath{\operatorname{sgn}} (b)$ is known\\
    参考模型 & $\dot{x}_{\ensuremath{\operatorname{ref}}} = -
    a_{\ensuremath{\operatorname{ref}}} x_{\ensuremath{\operatorname{ref}}} +
    b_{\ensuremath{\operatorname{ref}}} u_c$\\
    跟踪误差 & $e \triangleq x - x_{\ensuremath{\operatorname{ref}}}$\\
    控制输入 & $u = \hat{k}_1 (t) x + \hat{k}_2 (t) u_c$\\
    直接型MRAC控制律& $\dot{\hat{k}}_1 = -  \gamma_1
    \ensuremath{\operatorname{sgn}} (b) x  e, \dot{\hat{k}}_1 = -  \gamma_2
    \ensuremath{\operatorname{sgn}} (b)  u_c e ; \gamma_1, \gamma_2 > 0$\\
    \hline
  \end{tabular}
\end{table}

Design steps:
\begin{enumerate}
  \item Find a controller structure (based on known parameters)
  
  \item Derive the error dynamics
  
  \item Find a Lyapunov function
  
  \item Design parameter updating laws such that $\dot{V} \leq 0$.
\end{enumerate}

\subsection{标量系统的非直接型模型参考自适应控制}

\[\dot{x}=ax+bu\]

\[\dot{x}_{ref}=-a_{ref}x_{ref}+b_{ref}u_c,a_ref>0\]

\[\dot{\hat{b}}(t)=\begin{cases}
  \gamma_2ue&\text{若}\ |\hat{b}|>b_{\min}\\
  &\text{或}\ |\hat{b}|=b_{\min}\ \text{且}\ ue\sgn(b)\ge 0\\
  0&\text{其他}
\end{cases}\]
